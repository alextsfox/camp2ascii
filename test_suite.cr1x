Const scan_intvl = 500
Const storage_intvl = 1000
Const file_size = 300

Public seq
Public temp(8)
Public temp_bool8(2)
Public temp_nsec(8)
Public text_val As String * 32
Public toggle As Boolean
Units temp = degC
Units temp_bool8 = unitless

'' TOB1 with header/timestamp/record# to exercise most types
'DataTable (TOB1_Full, True, -1)
'  DataInterval (0, storage_intvl, mSec, 10)
'  TableFile ("CRD:TOB1_full", 0, -1, 0, file_size, Sec, 0, 0)
'  Average (1, temp(1), FP2, True)
'  Average (1, temp(2), IEEE4, True)
'  Average (1, temp(3), IEEE8, True)
'  Maximum (1, temp, FP2, False, True)
'  Sample (1, temp(1), FP2)
'  Sample (1, temp(2), IEEE4)
'  Sample (1, temp(3), IEEE8)
'  Sample (1, temp(4), UINT2)
'  Sample (1, temp(5), UINT4)
'  Sample (1, text_val, String)
'  Sample (1, toggle, Boolean)
'  Sample (2, temp_bool8, Bool8)
'  Sample (1, temp(8), Long)
'  Sample (1, temp_nsec, Nsec)
'EndTable
'
'' TOA5 with header/timestamp/record# plus append-mode variant to test incremental writes
'DataTable (TOA5_Full, True, -1)
'  DataInterval (0, storage_intvl, mSec, 10)
'  TableFile ("CRD:TOA5_full", 8, -1, 0, file_size, Sec, 0, 0)
'  Sample (1, temp(1), FP2)
'  Sample (1, temp(2), IEEE4)
'  Sample (1, temp(3), IEEE8)
'  Sample (1, temp(4), UINT2)
'  Sample (1, temp(5), UINT4)
'  Sample (1, text_val, String)
'  Sample (1, toggle, Boolean)
'  Sample (2, temp_bool8, Bool8)
'  Sample (1, temp(8), Long)
'EndTable

' TOB3 on CRD: to test frame parsing, filemarks, and ring behavior
DataTable (TOB3_Long, True, -1)
  DataInterval (0, storage_intvl, mSec, 10)
  TableFile ("CRD:TOB3_long", 64,10, 0, file_size, Sec, 0, 0)
  Sample (1, temp(1), FP2)
  Sample (1, temp(2), IEEE4)
  Sample (1, temp(3), IEEE8)
  Sample (1, temp(4), UINT2)
  Sample (1, temp(5), UINT4)
  Sample (1, text_val, String)
  Sample (1, toggle, Boolean)
  Sample (2, temp_bool8, Bool8)
  Sample (1, temp(8), Long)
EndTable

BeginProg
  Scan (scan_intvl, mSec, 3, 0)
    seq = seq + 1
    PanelTemp (temp(1), 60)
    Battery (temp(2))
    temp(3) = temp(1) * 1.1
    temp(4) = seq * 10
    temp(5) = seq * 1000
    text_val = Status.SerialNumber
    toggle = (seq MOD 2) <> 0

    ' introduce NANs every 7th sample for robustness testing
    If (seq MOD 7) = 0 Then temp(1) = NAN

    Move (temp_bool8(), 2, temp, 1)
    Move (temp_nsec(), 8, temp, 1)
    CallTable(TOB3_Long)
'    CallTable (TOB1_Full)
'    CallTable (TOA5_Full)
'    CallTable (TOB3_Ring)
  NextScan
EndProg

